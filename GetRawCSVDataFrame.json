{"id": "/subscriptions/0e40d638-6ee2-42fa-83d5-78641df4b3cb/resourceGroups/DataQualityPOC/providers/Microsoft.Synapse/workspaces/synapse-etl-poc/notebooks/GetRawCSVDataFrame", "name": "GetRawCSVDataFrame", "type": "Microsoft.Synapse/workspaces/notebooks", "etag": "0b00592e-0000-0100-0000-626bf7e90000", "properties": {"folder": {"name": "Testing_PoC/CSV/DNU"}, "targetSparkConfiguration": null, "entityState": null, "renameOperationDetails": null, "big_data_pool": {"type": "BigDataPoolReference", "reference_name": "apachesparkpool"}, "session_properties": {"driver_memory": "28g", "driver_cores": 4, "executor_memory": "28g", "executor_cores": 4, "num_executors": 2}, "metadata": {"sessionKeepAliveTimeout": 30, "saveOutput": true, "enableDebugMode": false, "a365ComputeOptions": {"id": "/subscriptions/0e40d638-6ee2-42fa-83d5-78641df4b3cb/resourceGroups/DataQualityPOC/providers/Microsoft.Synapse/workspaces/synapse-etl-poc/bigDataPools/apachesparkpool", "name": "apachesparkpool", "type": "Spark", "endpoint": "https://synapse-etl-poc.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/apachesparkpool", "auth": {"type": "AAD", "authResource": "https://dev.azuresynapse.net"}, "sparkVersion": "3.1", "nodeCount": 3, "cores": 16, "memory": 112, "extraHeader": null}, "synapse_widget": {"version": "0.1", "state": {"db8fc63f-aec4-4870-b774-7a7cd4230049": {"type": "Synapse.DataFrame", "sync_state": {"table": {"rows": [{"0": "32298", "1": "CA-2012-124891", "2": "41121", "3": "41121", "4": "Same Day", "5": "RH-19495", "6": "Rick Hansen", "7": "Consumer", "8": "New York City", "9": "New York", "10": "United States", "11": "10024", "12": "US", "13": "East", "14": "TEC-AC-10003033", "15": "Technology", "16": "Accessories", "17": "Plantronics CS510 - Over-the-Head monaural Wireless Headset System", "18": "2309.65", "19": "7", "20": "0", "21": "762.1845", "22": "933.57", "23": "Critical"}, {"0": "26341", "1": "IN-2013-77878", "2": "41310", "3": "41312", "4": "Second Class", "5": "JR-16210", "6": "Justin Ritter", "7": "Corporate", "8": "Wollongong", "9": "New South Wales", "10": "Australia", "12": "APAC", "13": "Oceania", "14": "FUR-CH-10003950", "15": "Furniture", "16": "Chairs", "17": "Novimex Executive Leather Armchair, Black", "18": "3709.395", "19": "9", "20": "0.1", "21": "-288.765", "22": "923.63", "23": "Critical"}, {"0": "25330", "1": "IN-2013-71249", "2": "41564", "3": "41565", "4": "First Class", "5": "CR-12730", "6": "Craig Reiter", "7": "Consumer", "8": "Brisbane", "9": "Queensland", "10": "Australia", "12": "APAC", "13": "Oceania", "14": "TEC-PH-10004664", "15": "Technology", "16": "Phones", "17": "Nokia Smart Phone, with Caller ID", "18": "5175.171", "19": "9", "20": "0.1", "21": "919.971", "22": "915.49", "23": "Medium"}, {"0": "13524", "1": "ES-2013-1579342", "2": "41302", "3": "41304", "4": "First Class", "5": "KM-16375", "6": "Katherine Murray", "7": "Home Office", "8": "Berlin", "9": "Berlin", "10": "Germany", "12": "EU", "13": "Central", "14": "TEC-PH-10004583", "15": "Technology", "16": "Phones", "17": "Motorola Smart Phone, Cordless", "18": "2892.51", "19": "5", "20": "0.1", "21": "-96.54", "22": "910.16", "23": "Medium"}, {"0": "47221", "1": "SG-2013-4320", "2": "41583", "3": "41584", "4": "Same Day", "5": "RH-9495", "6": "Rick Hansen", "7": "Consumer", "8": "Dakar", "9": "Dakar", "10": "Senegal", "12": "Africa", "13": "Africa", "14": "TEC-SHA-10000501", "15": "Technology", "16": "Copiers", "17": "Sharp Wireless Fax, High-Speed", "18": "2832.96", "19": "8", "20": "0", "21": "311.52", "22": "903.04", "23": "Critical"}], "schema": [{"key": "0", "name": "Row ID", "type": "string"}, {"key": "1", "name": "Order ID", "type": "string"}, {"key": "2", "name": "Order Date", "type": "string"}, {"key": "3", "name": "Ship Date", "type": "string"}, {"key": "4", "name": "Ship Mode", "type": "string"}, {"key": "5", "name": "Customer ID", "type": "string"}, {"key": "6", "name": "Customer Name", "type": "string"}, {"key": "7", "name": "Segment", "type": "string"}, {"key": "8", "name": "City", "type": "string"}, {"key": "9", "name": "State", "type": "string"}, {"key": "10", "name": "Country", "type": "string"}, {"key": "11", "name": "Postal Code", "type": "string"}, {"key": "12", "name": "Market", "type": "string"}, {"key": "13", "name": "Region", "type": "string"}, {"key": "14", "name": "Product ID", "type": "string"}, {"key": "15", "name": "Category", "type": "string"}, {"key": "16", "name": "Sub-Category", "type": "string"}, {"key": "17", "name": "Product Name", "type": "string"}, {"key": "18", "name": "Sales", "type": "string"}, {"key": "19", "name": "Quantity", "type": "string"}, {"key": "20", "name": "Discount", "type": "string"}, {"key": "21", "name": "Profit", "type": "string"}, {"key": "22", "name": "Shipping Cost", "type": "string"}, {"key": "23", "name": "Order Priority", "type": "string"}], "truncated": false}, "isSummary": false, "language": "scala"}, "persist_state": {"view": {"type": "details", "chartOptions": {"chartType": "bar", "aggregationType": "count", "categoryFieldKeys": ["0"], "seriesFieldKeys": ["0"], "isStacked": false}}}}}}, "kernelspec": {"name": "synapse_pyspark", "display_name": "Synapse PySpark"}, "language_info": {"name": "python"}}, "nbformat": 4, "nbformat_minor": 2, "cells": [{"execution_count": 1, "cell_type": "code", "metadata": {"jupyter": {"source_hidden": false, "outputs_hidden": false}, "nteract": {"transient": {"deleting": false}}}, "source": ["import pyodbc\r\n", "import openpyxl\r\n", "from openpyxl import load_workbook\r\n", "from openpyxl.utils.dataframe import dataframe_to_rows\r\n", "from openpyxl.worksheet.table import Table, TableStyleInfo\r\n", "import pandas as pd\r\n", "from pyspark.sql import Row, SparkSession\r\n", "import pyspark.sql.functions as F\r\n", "from pyspark.sql import SparkSession\r\n", "from pyspark.sql.types import *"], "outputs": []}, {"execution_count": 5, "cell_type": "code", "metadata": {"jupyter": {"source_hidden": false, "outputs_hidden": false}, "nteract": {"transient": {"deleting": false}}, "tags": ["parameters"]}, "source": ["object_name='global_superstore'\r\n", "account_name = \"etlstoragepocaccount\"\r\n", "container_name = \"etlstoragepocfilesystem\"\r\n", "relative_path = \"csv\""], "outputs": []}, {"execution_count": 3, "cell_type": "code", "metadata": {"jupyter": {"source_hidden": false, "outputs_hidden": false}, "nteract": {"transient": {"deleting": false}}}, "source": ["adls_path = 'abfss://%s@%s.dfs.core.windows.net/%s' % (container_name, account_name, relative_path)\r\n", "\r\n", "df1 = spark.read.option('header', 'true') \\\r\n", "                .option('delimiter', ',') \\\r\n", "                .csv(adls_path + '/'+object_name+'.csv')"], "outputs": []}, {"execution_count": 6, "cell_type": "code", "metadata": {"jupyter": {"source_hidden": false, "outputs_hidden": false}, "nteract": {"transient": {"deleting": false}}, "collapsed": false}, "source": ["mssparkutils.notebook.exit(df1)"], "outputs": []}]}}